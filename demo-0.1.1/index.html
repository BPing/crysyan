<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>demo-0.1.1</title>
    <script type="application/javascript" src="../lib/jquery-3.1.1.min.js"></script>

    <style type="text/css">
        button:hover,
        input[type=button]:hover {
            background: rgb(9, 147, 240);
        }
        button:active,
        input[type=button]:active {
            background: rgb(10, 118, 190);
        }
        button[disabled],
        input[type=button][disabled] {
            background: none;
            border: 1px solid rgb(187, 181, 181);
            color: gray;
            text-shadow: none;
        }
    </style>
</head>

<body>
<header>
    <div class="inner">
        <h1>Crysyan</h1>
        <h2>a web drawing board with canvas</h2>
        <a href="https://github.com/BPing/crysyan" class="button">
            <small>View project on</small>
            GitHub</a>
    </div>

</header>

<div id="content-wrapper">
    <div class="inner clearfix">
        <section id="main-content">

            <h1>
                <a id="crysyan" class="anchor" href="#crysyan" aria-hidden="true"><span aria-hidden="true"
                                                                                        class="octicon octicon-link"></span></a>crysyan
            </h1>
            <p>a web drawing board with canvas</p>

            <blockquote>
                <p>home: <a href="https://bping.github.io/crysyan/">https://bping.github.io/crysyan/</a></p>
            </blockquote>

            <a id="download-png" download="my-file-name.png" class="btn btn-github">download png</a>
            <button  id="start-record">start-record</button>
            <button  id="stop-record">stop-record</button>
            <div style="width:600px; height:600px;" class="crysyan-designer"></div>
            <div id="videoTag" style="width:600px; height:600px;" ></div>

        </section>

        <aside id="sidebar">
            <a href="../index.html" class="button">
                <small>Home</small>
                Home
            </a>
            <!--<a href="https://github.com/BPing/crysyan/releases/download/crysyan-0.0.9/crysyan-0.0.9.zip" class="button">-->
                <!--<small>Download</small>-->
                <!--0.0.9.zip-->
            <!--</a>-->
            <p class="repo-owner"><a href="https://github.com/BPing/crysyan"></a> is maintained by <a
                    href="https://github.com/BPing">BPing</a>.</p>

            <!--<p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>-->
        </aside>
    </div>
</div>


<script type="application/javascript" src="crysyan/crysyan-designer-min.js"></script>
<script type="application/javascript">
    $(".crysyan-designer").CrysyanDesigner({
        projectPath: "crysyan/",
        isRecord:true,
        canvas: {
            // px
            width: 500,
            height: 500
        },
        toobar: {
            length: 500
        }
    }, function (designer) {
        $("#download-png").click(function () {
            var canvas = designer.getView().crysyanCanvas;
            document.getElementById("download-png").href = canvas.toDataURL();

        });

        designer.drawBackgroupWithImage("img/pencil.png");

        var videoTag=document.getElementById("videoTag");
        var videoEle;

        var recorder = designer.getCanvasRecorder();

        $("#start-record").click(function () {
            document.getElementById('start-record').disabled = true;
            document.getElementById('stop-record').disabled = false;
            document.getElementById('start-record').innerHTML="Recording";
            console.log("recording");
            if (videoEle instanceof HTMLVideoElement) videoTag.removeChild(videoEle);
            recorder.initRecorder();
            recorder.startRecording();
        });

        $("#stop-record").click(function () {
            document.getElementById('start-record').disabled = false;
            document.getElementById('stop-record').disabled = true;
            document.getElementById('start-record').innerHTML="start-record";
            console.log("stop");
            recorder.stopRecording(function() {
                var blob = recorder.getBlob();
                videoEle = document.createElement('video');
                videoEle.src = URL.createObjectURL(blob);
                // videoEle.setAttribute('style', 'height: 100%; position: absolute; top:0; left:0;z-index:9999;width:100%;');
                videoTag.appendChild(videoEle);
                videoEle.controls = true;
                videoEle.play();
            });
        });
    });

    //
</script>

</body>
</html>
