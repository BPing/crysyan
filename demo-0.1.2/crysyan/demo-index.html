<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Demo</title>
    <script src="lib/jquery-3.1.1.min.js"></script>

    <style type="text/css">
        button:hover,
        input[type=button]:hover {
            background: rgb(9, 147, 240);
        }
        button:active,
        input[type=button]:active {
            background: rgb(10, 118, 190);
        }
        button[disabled],
        input[type=button][disabled] {
            background: none;
            border: 1px solid rgb(187, 181, 181);
            color: gray;
            text-shadow: none;
        }
    </style>
</head>
<body>
    <button type="button" id="start-record">start-record</button>
    <button  id="stop-record">stop-record</button>
    <div style="height:660px;" class="crysyan-designer"></div>
    <div id="videoTag" style="height:500px;"></div>
</body>

</html>
<script src="crysyan-designer-min.js"></script>
<script>
    $(".crysyan-designer").CrysyanDesigner({
        projectPath:"",
        isRecord:true,
        canvas: {
            // px
            width: 800,
            height: 500
        },
        toobar: {
            length: 500
        }
    }, function(designer) {
        console.dir(designer);
        var image=new Image();
        image.src="http://dream.com:9977/img/pencil.png";
        console.log(image instanceof Image);
        var dataurl = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAADFBMVEVYWFhVVVUAAABUVFTqqlXjAAAAA3RSTlMxdACUjPeLAAAATElEQVR42u3SQQrAMAwDQSn7/z+XFExTcOxroN3zgC4STecApy1gpP2gBgZXQMwKwJ23QITYACLlQBC9gAFNwJMXoJhVc7lBA/gsuAArEgqPcT12VgAAAABJRU5ErkJggg=="
        designer.drawBackgroupWithImage("img/pencil.png");

        var videoTag=document.getElementById("videoTag");
        var videoEle;
        var recorder = designer.getCanvasRecorder();
        $("#start-record").click(function () {
            document.getElementById('start-record').disabled = true;
            document.getElementById('stop-record').disabled = false;
            document.getElementById('start-record').innerHTML="Recording";
            console.log("recording");
            if (videoEle instanceof HTMLVideoElement) videoTag.removeChild(videoEle);
            recorder.initRecorder();
            recorder.startRecording();
        });
        $("#stop-record").click(function () {
            document.getElementById('start-record').disabled = false;
            document.getElementById('stop-record').disabled = true;
            document.getElementById('start-record').innerHTML="start-record";
            console.log("stop");
            recorder.stopRecording(function() {
                var blob = recorder.getBlob();
                videoEle = document.createElement('video');
                videoEle.src = URL.createObjectURL(blob);
                // videoEle.setAttribute('style', 'height: 100%; position: absolute; top:0; left:0;z-index:9999;width:100%;');
                videoTag.appendChild(videoEle);
                videoEle.controls = true;
                videoEle.play();
            });
        });
    });
</script>
