!function(){function e(){if(window.crypto&&window.crypto.getRandomValues&&navigator.userAgent.indexOf("Safari")===-1){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),r="",n=0,i=e.length;n<i;n++)r+=e[n].toString(36);return r}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function r(r,n){var i=this;i.appendTo=function(a){i.iframe=document.createElement("iframe"),i.iframe.name=r.ifrName?r.ifrName:"default-iframe"+e(),i.iframe.uid=i.iframe.name,i.iframe.src=(r.projectPath||"")+"html/crysyan.html?config="+JSON.stringify(r),i.iframe.style.width="100%",i.iframe.style.height="100%",i.iframe.style.border=0,i.iframe.onload=function(){n(i)},a.appendChild(i.iframe)},i.destroy=function(){i.iframe&&(i.iframe.parentNode.removeChild(i.iframe),i.iframe=null)},i.getView=function(){return window[i.iframe.uid].Crysyan.getView()},i.drawBackgroupWithImage=function(e){var r=window[i.iframe.uid].Crysyan.getView();r.crysyanCanvas.drawBackgroupWithImage(e,1)},i.toDataUrl=function(e){"undefined"==typeof e&&(e="image/png");var r=window[i.iframe.uid].Crysyan.getView();return r.crysyanCanvas.toDataURL(e)}}if(!window.$){var n=window.parent.$||window.jQuery;if(!n)throw new Error("Crysyan requires 'jQuery'");window.$=n}$.fn.CrysyanDesigner=function(e,n){var i=this;i.each(function(){new r(e,n).appendTo(this)})},window.CrysyanDesigner=r}();